<?php
require '../config.php';

include '../support elements/admin-nav.php';

if (isset($_POST['added'])) {
    $collegename = $_POST["collegename"];
    $website_link = $_POST["websitelink"];
    $college_description = $_POST["collegedescription"];
    $subjects = $_POST["subjects"];

    print($subject);

  if (!empty($collegename)) {
    $query = "INSERT INTO 
    colleges (name) 
    VALUES ('$collegename')";

    if (/*@mysqli_query($conn, $query)*/false) {
      ?>
      <!DOCUMENT html>
      <html>
        <head>
          <title>Success | Admin Panel</title>
          <link rel="stylesheet" href="../resources/style-admin.css">
          <link rel="preconnect" href="https://fonts.gstatic.com">
          <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
        </head>
        <body>
          <div class="main-container">
            <h1>Database Updated Successfully</h1>
            <a href = "listing.php">Back to college listings</a>
          </div>
        </body>
      </html>
      <?php
    } else {
      //print mysqli_error($conn);
      print($subject);
    }
  }
} else {
  try {
    $pdo = new PDO('mysql:host=' . $dbServername . ';dbname=' . $dbName . ';charset=utf8', $dbUsername);
  } catch (PDOException $exception) {
    // If there is an error with the connection, stop the script and display the error.
    exit('Failed to connect to database!');
  }

  $query_select_subject = "SELECT * FROM college_website.subjects";

  $subjects = $pdo->query($query_select_subject)->fetchAll();
  
  ?>
  <!DOCUMENT html>
  <html>

    <head>
    	<title>Add College | Admin Panel</title>
    	<link rel="stylesheet" href="../../css/style-admin.css" />
    	<link rel="preconnect" href="https://fonts.gstatic.com" />
    	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat%26display=swap" /> 
    </head>

    <body>
    	<div class="main-container">
    		<h1 align="center">New College</h1>
    		<div class="form-center">
    			<form action="add-college.php" method="POST">
    				<label for="collegename">College Name: </label>
    				<input type="text" name="collegename" id="collegename" />
    				<br/>
    				<br/>
            <label for="websitelink">Website Link: </label>
    				<input type="text" name="websitelink" id="websitelink" />
    				<br/>
    				<br/>
    				<textarea rows="4" cols="50" name="collegedescription" id="collegedescription" form="edit-form" placeholder="Description"></textarea>
    				<br/>
    				<br/>
    				<br/>
            <?php
            /*
            <div style="display: flex; flex-direction: column;">
            <?php foreach ($subjects as $subject) : ?>
              <div>
                <!-- input's name has '[]' in the end to signify that post will be a 2 dimensional array where items are grouped by subject_id and have -->
                <input type="checkbox" name="subject[][name]" value="<?= $subject["subject_id"]?>" id="">
                <label for="subjects"><?= $subject["name"] ?></label>

                <input type="number" name="subject[][price]" step="100">
              </div>
            <?php endforeach ?>

            </div>
            */
            ?>
            <input class="edit-button" type="submit" name="submit" value="Add college" />
    				<input type='hidden' name='added' value='true' /> 
          </form>
    		</div>
    	</div>
    </body>

</html>
  <?php
}
?>